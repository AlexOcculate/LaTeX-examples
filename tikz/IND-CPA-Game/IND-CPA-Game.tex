\documentclass{article}
\usepackage[pdftex,active,tightpage]{preview}

\usepackage{tikz}
\usetikzlibrary{calc}

\begin{document}
\begin{preview}
\tikzstyle{vertex}=[draw,fill=black!15,circle,minimum size=20pt,inner sep=0pt]
\tikzstyle{encrypt}=[draw,fill=black!15,rectangle,minimum size=20pt,inner sep=0pt]
\begin{tikzpicture}
    \node (A)[draw, minimum height=2cm,fill=black!15] at (0,0) {$\mathcal{A}$};
    \node (E)[draw, minimum height=2cm,fill=black!15] at (4,0) {$Enc(K, \cdot)$};

    \draw[->,thick] (A.north east)     -- node[sloped, above=-0.1cm] {$\scriptstyle M^{(1)}$} (E.north west);
    \draw[->,thick] (A.60)             -- node[sloped, above=-0.1cm] {$\scriptstyle M^{(2)}$} (E.150);
    \draw[->,thick] (E.179)            -- node[sloped, above=-0.1cm] {$\scriptstyle C^* = Enc(K, M^{(b)})$} (A.east);

    \draw[->,thick] (A.south)|- node[sloped, above=0.19cm,right=0.3cm] {rate $b$} (2,-2);
    \draw[<-,very thick] (-0.5,-2) -- node[sloped, above=-0.05cm] {Zeit} (-0.5,1.5);
\end{tikzpicture}
\end{preview}
\end{document}
